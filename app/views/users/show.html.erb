<% provide(:title, @user.name) %>

<!-- Name and Gravatar, in <aside> -->
<div class="row">
  <aside class="col-md-4">
    <section class="user_info">
      <h1>
        <%= gravatar_for(@user, size: 80) %>
        <%= @user.name %>
      </h1>
      <br>Joined: <%= @user.created_at.strftime("%B %d, %Y") %>
    </section>
  </aside>

  <!-- Title and Description -->
  <div class="title_desc col-md-8">
      <%
        # If no title yet, show grey link, which activates a JS method that
        # displays an edit form. If there is a title, show it with an edit
        # pencil.
      %>
      <% if current_user == @user %>
        <!-- Always load this initially hidden span, whether or not used -->
        <!-- Display to user when opened -->
        <span id="edit_user_title" %>
          <%= form_for(@user, url: update_description_user_path,
                       method: :patch) do |f| %>
            <span class="input_buttons">
              <%= button_tag "", type: 'submit', class: "btn btn-default
                  glyphicon glyphicon-ok" %>
            </span>
            <span class="input_field">
              <%= f.text_field :title, class: 'form-control title_input' %>
            </span>
          <% end %>
        </span>
        <% if @user.title %>
          <!-- Display user title to user -->
          <h2 class="user_title">
            <span class="glyphicon glyphicon-play"></span>&nbsp;
            <span id="user_title_text"><%= @user.title %>&nbsp;&nbsp;</span>
            <span class="glyphicon glyphicon-pencil"></span>
          </h2>
<!-- NOT SURE WHY THIS ISN'T WORKING
          <% if session[:bad_title] %>
            <script>
              var ready = function() {
                showEditUserTitle();
              };
              $(document).ready(ready);
              $(document).on('page:load', ready);
            </script>
          <% end %>
-->
        <% else %>
          <h2 class="user_title">
            <span id="user_title_text" class="italics silver">
              Click to add profile title</span>
            <span class="glyphicon glyphicon-plus silver"></span>
          </h2>
        <% end %>
      <% elsif current_user != @user %>
        <% if @user.title %>
          <!-- Display user title to other user -->
          <h2 class="user_title_other_user">
            <span class="glyphicon glyphicon-play"></span>&nbsp;
            <span class="user_title_text"><%= @user.title %>&nbsp;&nbsp;</span>
          </h2>
        <% end %>
      <% end %>
  </div>
</div>
